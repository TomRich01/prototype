(function(b){var a=b.fn.attr;b.fn.attr=function(){var c,e,d,f;if(this[0]&&arguments.length===0){f={};d=this[0].attributes;e=d.length;for(c=0;c<e;c++){f[d[c].name.toLowerCase()]=d[c].value}return f}else{return a.apply(this,arguments)}}}(jQuery));var nexus={parse_template:function(d,e){d=d||"";e=e||{};var c=/\(#(.*?)#\)/g;var f=d;var a;while((a=c.exec(f))!==null){if(a.index===c.lastIndex){c.lastIndex++}var b=a[0].replace("(#","").replace("#)","");if(e[b]){d=d.replace(a[0],e[b].toString())}else{d=d.replace(a[0],"")}}return d},get_template:function(b){var a=null;if(b){a=$(b)||$("#"+b)||$("#template_"+b)}if(a){a=$(a).text()}return a}};function twentyfour_gallery(a,b){this.prefix="twentyfour_gallery_";this.container=null;this.interval=null;this.stage=null;this.slide_index=0;this.slides=[];this.templates={gallery:null,stage:null,media_bar:null};this.buttons={};this.settings={container_class:"twentyfour gallery",fullscreen_icon_class:"icon-expand",play_icon_class:"icon-playback-play",pause_icon_class:"icon-playback-pause",nav_left_icon_class:"icon-angle-left",nav_right_icon_class:"icon-angle-right",toggle_tray_icon_class:"icon-th",gallery_template_selector:"#twentyfour_gallery_template",tray_template_selector:"#twentyfour_gallery_tray_template",media_bar_template_selector:"#twentyfour_gallery_media_bar_template",stage_template_selector:"#twentyfour_gallery_stage_template",query_selector:".gallery24",show_speed:3000,autolink_css:true,thumbnail_selector:".thumbnail",minimum_slides:2,fullsize_image_attribute:"data-original-url"};this.go_fullscreen=function(){var c=this.container[0];if(c.requestFullscreen){c.requestFullscreen()}else{if(c.mozRequestFullScreen){c.mozRequestFullScreen()}else{if(c.webkitRequestFullscreen){c.webkitRequestFullscreen()}else{if(c.msRequestFullscreen){c.msRequestFullscreen()}}}}this.container.addClass("fullscreen")};this.exit_fullscreen=function(){if(document.exitFullscreen){document.exitFullscreen()}else{if(document.mozCancelFullScreen){document.mozCancelFullScreen()}else{if(document.webkitExitFullscreen){document.webkitExitFullscreen()}else{if(document.msExitFullscreen){document.msExitFullscreen()}}}}this.container.removeClass("fullscreen")};this.toggle_fullscreen=function(e){var c,d;c=this.container;if(this.container.hasClass("fullscreen")){this.exit_fullscreen()}else{this.go_fullscreen()}};this.go_to_slide=function(c){if(c<0){c=this.slides.length-1;$(this.container).addClass("last")}else{$(this.container).removeClass("last")}if(c>this.slides.length-1){c=0;$(this.container).addClass("first")}else{$(this.container).removeClass("first")}this.slide_index=c;$(this.stage).find(">.slider").css("margin-left",(-(c*100))+"%");$(this.tray).find(">.slider>.slide").each(function(e){$(this).removeClass("active")});var d=$(this.tray).find(">.slider>.slide")[this.slide_index];$(d).addClass("active");if($(d).is(":visible")){console.debug("current thumbnail is visible")}else{console.debug("current thumbnail is NOT visible")}$(this.media_bar).find(".current").text(this.slide_index+1);return this.slide_index};this.toggle_show=function(){$(this.container).toggleClass("playing");if($(this.container).hasClass("playing")){this.play()}else{this.pause()}};this.toggle_tray=function(){$(this.container).toggleClass("show_tray")};this.play=function(){var c=this;this.interval=setInterval(function(){c.go_to_slide(c.slide_index+1)},this.settings.show_speed)}.bind(this);this.pause=function(){clearInterval(this.interval)};this.add_event_listeners=function(){var c=this;$(this.tray).find(".slide").each(function(d){$(this).click(function(e){c.go_to_slide(d)})});$(this.media_bar).find(".play_pause_toggle").click(function(){c.toggle_show()}).bind(c);$(this.media_bar).find(".tray_toggle").click(function(){c.toggle_tray()}).bind(c);$(this.container).find(".action_area.nav.left").click(function(){c.go_to_slide(c.slide_index-1)}).bind(c);$(this.container).find(".action_area.nav.right").click(function(){c.go_to_slide(c.slide_index+1)}).bind(c);this.buttons.fullscreen.click(c.toggle_fullscreen.bind(c));$(document).bind("webkitfullscreenchange mozfullscreenchange fullscreenchange MSFullscreenChange",function(g){var f=document.mozFullScreen||document.webkitIsFullScreen||document.msFullscreenEnabled||document.fullScreen;var d=f?"FullscreenOn":"FullscreenOff";if(document.msFullscreenEnabled&&document.msFullscreenElement==null){d="FullscreenOff"}if(d=="FullscreenOff"){c.exit_fullscreen()}})};this.generate_slides=function(){var d="";for(var c=0;c<this.slides.length;c++){d+=$(this.slides[c])[0].outerHTML}return d};this.generate_thumbnails=function(){thumbnails="";for(var c=0;c<this.slides.length;c++){thumbnails+=$(this.slides[c])[0].outerHTML}return thumbnails};this.generate_attributes=function(){var e="";this.attributes["class"]=this.attributes["class"]||"";this.attributes["class"]+=" "+this.settings.container_class;for(var d=0;d<Object.keys(this.attributes).length;d++){var c=Object.keys(this.attributes)[d];var f=this.attributes[c];e+=c+"='"+f+"'"}return e};this.update_settings=function(c){$.extend(this.settings,c)};this.update_templates=function(c){c=c||{};$.extend(c,this.settings);c.slides=this.generate_slides();c.thumbnails=this.generate_thumbnails();c.total_slides=this.slides.length;c.attributes=this.generate_attributes();this.templates.stage=nexus.get_template(this.settings.stage_template_selector);this.templates.stage=nexus.parse_template(this.templates.stage,c);c.stage=this.templates.stage;this.templates.tray=nexus.get_template(this.settings.tray_template_selector);this.templates.tray=nexus.parse_template(this.templates.tray,c);c.tray=this.templates.tray;this.templates.media_bar=nexus.get_template(this.settings.media_bar_template_selector);this.templates.media_bar=nexus.parse_template(this.templates.media_bar,c);c.media_bar=this.templates.media_bar;this.templates.gallery=nexus.get_template(this.settings.gallery_template_selector);this.templates.gallery=nexus.parse_template(this.templates.gallery,c)};this.init=function(e,d){gallery=this;this.container=e;var c=$(this.container).find(".slide");if(c.length<this.settings.minimum_slides){console.group("TwentyFour Gallery");console.info("too few slides");console.groupEnd();return null}$(c).each(function(g){gallery.slides[g]=$(this)});this.attributes=this.container.attr();this.update_settings(d);this.update_settings(this.container.data());var f=this.container.attr("id")||this.prefix+Math.round(Math.random()*100);this.update_templates({id:f});this.container.replaceWith(this.templates.gallery);this.container=$("#"+f);this.stage=$(this.container).find(">.stage");this.tray=$(this.container).find(">.tray");this.media_bar=$(this.container).find(">.media_bar");this.buttons.fullscreen=this.container.find(".icon.fullscreen");this.add_event_listeners();this.go_to_slide(0);this.container.addClass("ready");return this}.bind(this);return this.init(a,b)}$(document).ready(function(){$("[data-embed24=Images]").each(function(){new twentyfour_gallery($(this))})});